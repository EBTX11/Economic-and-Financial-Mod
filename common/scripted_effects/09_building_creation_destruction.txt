######## bank_central

gdp_view_on_action = {
	if = {
		limit = {
			gdp_var > 10000000
		}
		set_variable = {
			name = gdp_view
			value = 1
		}
	}
	if = {
		limit = {
			gdp_var > 20000000
		}
		set_variable = {
			name = gdp_view
			value = 2
		}
	}
	if = {
		limit = {
			gdp_var > 30000000
		}
		set_variable = {
			name = gdp_view
			value = 3
		}
	}
	if = {
		limit = {
			gdp_var > 40000000
		}
		set_variable = {
			name = gdp_view
			value = 4
		}
	}
	if = {
		limit = {
			gdp_var > 50000000
		}
		set_variable = {
			name = gdp_view
			value = 5
		}
	}
	if = {
		limit = {
			gdp_var > 60000000
		}
		set_variable = {
			name = gdp_view
			value = 6
		}
	}
	if = {
		limit = {
			gdp_var > 70000000
		}
		set_variable = {
			name = gdp_view
			value = 7
		}
	}
	if = {
		limit = {
			gdp_var > 80000000
		}
		set_variable = {
			name = gdp_view
			value = 8
		}
	}
	if = {
		limit = {
			gdp_var > 90000000
		}
		set_variable = {
			name = gdp_view
			value = 9
		}
	}
	if = {
		limit = {
			gdp_var > 100000000
		}
		set_variable = {
			name = gdp_view
			value = 10
		}
	}
	if = {
		limit = {
			gdp_var > 110000000
		}
		set_variable = {
			name = gdp_view
			value = 11
		}
	}
	if = {
		limit = {
			gdp_var > 120000000
		}
		set_variable = {
			name = gdp_view
			value = 12
		}
	}
	if = {
		limit = {
			gdp_var > 130000000
		}
		set_variable = {
			name = gdp_view
			value = 13
		}
	}
	if = {
		limit = {
			gdp_var > 140000000
		}
		set_variable = {
			name = gdp_view
			value = 14
		}
	}
	if = {
		limit = {
			gdp_var > 150000000
		}
		set_variable = {
			name = gdp_view
			value = 15
		}
	}
	if = {
		limit = {
			gdp_var > 160000000
		}
		set_variable = {
			name = gdp_view
			value = 16
		}
	}
	if = {
		limit = {
			gdp_var > 170000000
		}
		set_variable = {
			name = gdp_view
			value = 17
		}
	}
	if = {
		limit = {
			gdp_var > 180000000
		}
		set_variable = {
			name = gdp_view
			value = 18
		}
	}
	if = {
		limit = {
			gdp_var > 190000000
		}
		set_variable = {
			name = gdp_view
			value = 19
		}
	}
	if = {
		limit = {
			gdp_var > 200000000
		}
		set_variable = {
			name = gdp_view
			value = 20
		}
	}
	if = {
		limit = {
			gdp_var > 210000000
		}
		set_variable = {
			name = gdp_view
			value = 21
		}
	}
	if = {
		limit = {
			gdp_var > 220000000
		}
		set_variable = {
			name = gdp_view
			value = 22
		}
	}
	if = {
		limit = {
			gdp_var > 230000000
		}
		set_variable = {
			name = gdp_view
			value = 23
		}
	}
	if = {
		limit = {
			gdp_var > 240000000
		}
		set_variable = {
			name = gdp_view
			value = 24
		}
	}
	if = {
		limit = {
			gdp_var > 250000000
		}
		set_variable = {
			name = gdp_view
			value = 25
		}
	}
	if = {
		limit = {
			gdp_var > 260000000
		}
		set_variable = {
			name = gdp_view
			value = 26
		}
	}
	if = {
		limit = {
			gdp_var > 270000000
		}
		set_variable = {
			name = gdp_view
			value = 27
		}
	}
	if = {
		limit = {
			gdp_var > 280000000
		}
		set_variable = {
			name = gdp_view
			value = 28
		}
	}
	if = {
		limit = {
			gdp_var > 290000000
		}
		set_variable = {
			name = gdp_view
			value = 29
		}
	}
	if = {
		limit = {
			gdp_var > 300000000
		}
		set_variable = {
			name = gdp_view
			value = 30
		}
	}
	if = {
		limit = {
			gdp_var > 310000000
		}
		set_variable = {
			name = gdp_view
			value = 31
		}
	}
	if = {
		limit = {
			gdp_var > 320000000
		}
		set_variable = {
			name = gdp_view
			value = 32
		}
	}
	if = {
		limit = {
			gdp_var > 330000000
		}
		set_variable = {
			name = gdp_view
			value = 33
		}
	}
	if = {
		limit = {
			gdp_var > 340000000
		}
		set_variable = {
			name = gdp_view
			value = 34
		}
	}
	if = {
		limit = {
			gdp_var > 350000000
		}
		set_variable = {
			name = gdp_view
			value = 35
		}
	}
	if = {
		limit = {
			gdp_var > 360000000
		}
		set_variable = {
			name = gdp_view
			value = 36
		}
	}
	if = {
		limit = {
			gdp_var > 370000000
		}
		set_variable = {
			name = gdp_view
			value = 37
		}
	}
	if = {
		limit = {
			gdp_var > 380000000
		}
		set_variable = {
			name = gdp_view
			value = 38
		}
	}
	if = {
		limit = {
			gdp_var > 390000000
		}
		set_variable = {
			name = gdp_view
			value = 39
		}
	}
	if = {
		limit = {
			gdp_var > 400000000
		}
		set_variable = {
			name = gdp_view
			value = 40
		}
	}
	if = {
		limit = {
			gdp_var > 410000000
		}
		set_variable = {
			name = gdp_view
			value = 41
		}
	}
	if = {
		limit = {
			gdp_var > 420000000
		}
		set_variable = {
			name = gdp_view
			value = 42
		}
	}
	if = {
		limit = {
			gdp_var > 430000000
		}
		set_variable = {
			name = gdp_view
			value = 43
		}
	}
	if = {
		limit = {
			gdp_var > 440000000
		}
		set_variable = {
			name = gdp_view
			value = 44
		}
	}
	if = {
		limit = {
			gdp_var > 450000000
		}
		set_variable = {
			name = gdp_view
			value = 45
		}
	}
	if = {
		limit = {
			gdp_var > 460000000
		}
		set_variable = {
			name = gdp_view
			value = 46
		}
	}
	if = {
		limit = {
			gdp_var > 470000000
		}
		set_variable = {
			name = gdp_view
			value = 47
		}
	}
	if = {
		limit = {
			gdp_var > 480000000
		}
		set_variable = {
			name = gdp_view
			value = 48
		}
	}
	if = {
		limit = {
			gdp_var > 490000000
		}
		set_variable = {
			name = gdp_view
			value = 49
		}
	}
	if = {
		limit = {
			gdp_var > 500000000
		}
		set_variable = {
			name = gdp_view
			value = 50
		}
	}
}

#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################

# ██████╗  █████╗ ███╗   ██╗██╗  ██╗         ██████╗███████╗███╗   ██╗████████╗██████╗  █████╗ ██╗
# ██╔══██╗██╔══██╗████╗  ██║██║ ██╔╝        ██╔════╝██╔════╝████╗  ██║╚══██╔══╝██╔══██╗██╔══██╗██║
# ██████╔╝███████║██╔██╗ ██║█████╔╝         ██║     █████╗  ██╔██╗ ██║   ██║   ██████╔╝███████║██║
# ██╔══██╗██╔══██║██║╚██╗██║██╔═██╗         ██║     ██╔══╝  ██║╚██╗██║   ██║   ██╔══██╗██╔══██║██║
# ██████╔╝██║  ██║██║ ╚████║██║  ██╗███████╗╚██████╗███████╗██║ ╚████║   ██║   ██║  ██║██║  ██║███████╗
# ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═══╝╚═╝  ╚═╝╚══════╝ ╚═════╝╚══════╝╚═╝  ╚═══╝   ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝

#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################

bank_central_place = {
	capital = {
		save_scope_as = capital_scope
	}
	every_scope_state = {
		if = {
			limit = {
				has_modifier = bank_central_place
			}
			remove_modifier = bank_central_place
		}
	}
	scope:capital_scope = {
		if = {
			limit = {
				has_modifier = bank_central_place
			}
			remove_modifier = bank_central_place
		}
		add_modifier = {
			name = bank_central_place
			#months = short_modifier_time
		}
		if = {
			limit = {
				has_modifier = bank_central_place
				not = {
					has_modifier = bank_central_historic_place
				}
			}
			remove_modifier = bank_central_historic_place
			add_modifier = {
				name = bank_central_historic_place
			}
		}
	}
}

bank_central_destroy = {
	every_scope_state = {
		if = {
			limit = {
				and = {
					has_building = building_bank
					NOT = {
						has_modifier = bank_central_place
					}
				}
			}
			remove_building = building_bank
		}
	}
}

has_central_bank = {
	if = {
		limit = {
			any_scope_state = {
				has_building = building_bank
			}
			not  = {
				has_modifier = has_central_bank
			}
		}
		add_modifier = {
			name = has_central_bank
		}
	}
}

has_not_central_bank = {
	if = {
		limit = {
			has_modifier = has_central_bank
			any_scope_state = {
				not  = {
					has_building = building_bank
				}
			}
		}
		remove_modifier = {
			name = has_central_bank
		}
		#activate_law = law_type:law_no_market_liquidity
	}
}

#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################

# ███████╗██╗███╗   ██╗ █████╗ ███╗   ██╗ ██████╗██╗ █████╗ ██╗              ██████╗███████╗███╗   ██╗████████╗███████╗██████╗
# ██╔════╝██║████╗  ██║██╔══██╗████╗  ██║██╔════╝██║██╔══██╗██║             ██╔════╝██╔════╝████╗  ██║╚══██╔══╝██╔════╝██╔══██╗
# █████╗  ██║██╔██╗ ██║███████║██╔██╗ ██║██║     ██║███████║██║             ██║     █████╗  ██╔██╗ ██║   ██║   █████╗  ██████╔╝
# ██╔══╝  ██║██║╚██╗██║██╔══██║██║╚██╗██║██║     ██║██╔══██║██║             ██║     ██╔══╝  ██║╚██╗██║   ██║   ██╔══╝  ██╔══██╗
# ██║     ██║██║ ╚████║██║  ██║██║ ╚████║╚██████╗██║██║  ██║███████╗███████╗╚██████╗███████╗██║ ╚████║   ██║   ███████╗██║  ██║
# ╚═╝     ╚═╝╚═╝  ╚═══╝╚═╝  ╚═╝╚═╝  ╚═══╝ ╚═════╝╚═╝╚═╝  ╚═╝╚══════╝╚══════╝ ╚═════╝╚══════╝╚═╝  ╚═══╝   ╚═╝   ╚══════╝╚═╝  ╚═╝

#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################

financial_center_place = {
    capital = {
        save_scope_as = capital_scope
    }
    every_scope_state = {
        if = {
            limit = {
                has_modifier = financial_center_place
            }
            remove_modifier = financial_center_place
        }
    }
    scope:capital_scope = {
        if = {
            limit = {
                has_modifier = financial_center_place
            }
            remove_modifier = financial_center_place
        }
        add_modifier = {
            name = financial_center_place
        }
        if = {
            limit = {
                and = {
                    has_modifier = financial_center_place
                    not = {
                        has_modifier = financial_center_historic_place
                    }
                }
            }
            remove_modifier = financial_center_historic_place
            add_modifier = {
                name = financial_center_historic_place
            }
        }
    }
}

#finds special fc buildings and resets modifiers in that state to match
financial_center_place_spe = {
    every_scope_state = {
        limit = {
            or = {
                has_building = building_financial_centre_fra
                has_building = building_financial_centre_gbr
                has_building = building_financial_centre_usa
                has_building = building_financial_centre_net
                has_building = building_financial_centre_ger
                has_building = building_financial_centre_aus
                has_building = building_financial_centre_ita
                has_building = building_financial_centre_chi
                has_building = building_financial_centre_jap
            }
        }
        save_scope_as = financial_center_place_scope
	}
    every_scope_state = {
        if = {
            limit = {
                has_modifier = financial_center_place_spe
            }
            remove_modifier = financial_center_place_spe
        }
        #financial_center_place
        if = {
            limit = {
                has_modifier = financial_center_place
            }
            remove_modifier = financial_center_place
        }
    }
    scope:financial_center_place_scope = {
        if = {
            limit = {
                has_modifier = financial_center_place_spe
            }
            remove_modifier = financial_center_place_spe
        }
        add_modifier = {
            name = financial_center_place_spe
        }
        if = {
            limit = {
                and = {
                    has_modifier = financial_center_place_spe
                    not = {
                        has_modifier = financial_center_historic_place
                    }
                }
            }
            remove_modifier = financial_center_historic_place
            add_modifier = {
                name = financial_center_historic_place
            }
        }
    }
}

financial_center_destroy = {
    every_scope_state = {
        if = {
            limit = {
                and = {
                    has_building = building_financial_centre
                    NOT = {
                        has_modifier = financial_center_place
                    }
                }
            }
            remove_building = building_financial_centre
        }
    }
}

#Disfonction
financial_center_destroy_spe = {
    every_scope_state = {
        limit = {
            has_building = building_financial_centre

        }
        remove_building = building_financial_centre
    }
}

has_financial_center = {
	if = {
		limit = {
            any_scope_state = {
                or = {
                    has_building = building_financial_centre
                    has_building = building_financial_centre_fra
                    has_building = building_financial_centre_gbr
                    has_building = building_financial_centre_usa
                    has_building = building_financial_centre_net
                    has_building = building_financial_centre_ger
                    has_building = building_financial_centre_aus
                    has_building = building_financial_centre_ita
                    has_building = building_financial_centre_chi
                    has_building = building_financial_centre_jap
                }
            }
            not  = {
                has_modifier = has_financial_center
            }
		}
        add_modifier = {
            name = has_financial_center
        }
    }
}

has_not_financial_center = {
	if = {
		limit = {
            has_modifier = has_financial_center
            any_scope_state = {
                not  = {
                    has_building = building_financial_centre
                    or = {
                        has_building = building_financial_centre_fra
                        has_building = building_financial_centre_gbr
                        has_building = building_financial_centre_usa
                        has_building = building_financial_centre_net
                        has_building = building_financial_centre_ger
                        has_building = building_financial_centre_aus
                        has_building = building_financial_centre_ita
                        has_building = building_financial_centre_chi
                        has_building = building_financial_centre_jap
                    }
                }
            }
		}
        remove_modifier = {
            name = has_financial_center
        }
    }
}

#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################

# ███╗   ██╗ █████╗ ████████╗██╗ ██████╗ ███╗   ██╗ █████╗ ██╗             ███████╗████████╗ ██████╗  ██████╗██╗  ██╗██████╗ ██╗██╗     ███████╗
# ████╗  ██║██╔══██╗╚══██╔══╝██║██╔═══██╗████╗  ██║██╔══██╗██║             ██╔════╝╚══██╔══╝██╔═══██╗██╔════╝██║ ██╔╝██╔══██╗██║██║     ██╔════╝
# ██╔██╗ ██║███████║   ██║   ██║██║   ██║██╔██╗ ██║███████║██║             ███████╗   ██║   ██║   ██║██║     █████╔╝ ██████╔╝██║██║     █████╗
# ██║╚██╗██║██╔══██║   ██║   ██║██║   ██║██║╚██╗██║██╔══██║██║             ╚════██║   ██║   ██║   ██║██║     ██╔═██╗ ██╔═══╝ ██║██║     ██╔══╝
# ██║ ╚████║██║  ██║   ██║   ██║╚██████╔╝██║ ╚████║██║  ██║███████╗███████╗███████║   ██║   ╚██████╔╝╚██████╗██║  ██╗██║     ██║███████╗███████╗
# ╚═╝  ╚═══╝╚═╝  ╚═╝   ╚═╝   ╚═╝ ╚═════╝ ╚═╝  ╚═══╝╚═╝  ╚═╝╚══════╝╚══════╝╚══════╝   ╚═╝    ╚═════╝  ╚═════╝╚═╝  ╚═╝╚═╝     ╚═╝╚══════╝╚══════╝

#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################

national_stockpile_place = {
    capital = {
        save_scope_as = capital_scope
    }
    every_scope_state = {
        if = {
            limit = {
                has_modifier = national_stockpile_place
            }
            remove_modifier = national_stockpile_place
        }
    }
    scope:capital_scope = {
        if = {
            limit = {
                has_modifier = national_stockpile_place
            }
            remove_modifier = national_stockpile_place
        }
        add_modifier = {
            name = national_stockpile_place
        }
        if = {
            limit = {
                has_modifier = national_stockpile_place
                not = {
                    has_modifier = national_stockpile_historic_place
                }
            }
            add_modifier = {
                name = national_stockpile_historic_place
            }
        }
    }
}

national_stockpile_destroy = {
    every_scope_state = {
        if = {
            limit = {
                and = {
                    has_building = building_national_stockpile
                    NOT = {
                        has_modifier = national_stockpile_place
                    }
                }
            }
            remove_building = building_national_stockpile
        }
    }
}

has_national_stockpile = {
	if = {
		limit = {
            any_scope_state = {
                has_building = building_national_stockpile
            }
            not  = {
                has_modifier = has_national_stockpile
            }
		}
        add_modifier = {
            name = has_national_stockpile
        }
    }
}

has_not_central_bank = {
	if = {
		limit = {
            has_modifier = has_national_stockpile
            any_scope_state = {
                not  = {
                    has_building = building_national_stockpile
                }
            }
		}
        remove_modifier = {
            name = has_national_stockpile
        }
    }
}

#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################

# ██████╗  ██████╗       ██╗       ███████╗ ██████╗     ██████╗██████╗ ███████╗ █████╗ ████████╗██╗ ██████╗ ███╗   ██╗
# ██╔══██╗██╔════╝       ██║       ██╔════╝██╔════╝    ██╔════╝██╔══██╗██╔════╝██╔══██╗╚══██╔══╝██║██╔═══██╗████╗  ██║
# ██████╔╝██║         ████████╗    █████╗  ██║         ██║     ██████╔╝█████╗  ███████║   ██║   ██║██║   ██║██╔██╗ ██║
# ██╔══██╗██║         ██╔═██╔═╝    ██╔══╝  ██║         ██║     ██╔══██╗██╔══╝  ██╔══██║   ██║   ██║██║   ██║██║╚██╗██║
# ██████╔╝╚██████╗    ██████║      ██║     ╚██████╗    ╚██████╗██║  ██║███████╗██║  ██║   ██║   ██║╚██████╔╝██║ ╚████║
# ╚═════╝  ╚═════╝    ╚═════╝      ╚═╝      ╚═════╝     ╚═════╝╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝   ╚═╝   ╚═╝ ╚═════╝ ╚═╝  ╚═══╝

#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################

## for adding central bank and flavored financial center at game start
initialize_historic_special_macro_facilities = {
	add_technology_researched = financial_center
	add_technology_researched = central_banking
	add_technology_researched = gold_standard
	add_technology_researched = stock_exchange

	$CTRL_BANK_SITE$ = {
		create_building = {
			building = $BANK_BLDG_TYPE$
			level    = $CB_SIZE$
			reserves = 0
		}
		add_modifier = {
			name = bank_central_place
		}
		add_modifier = {
			name = bank_central_historic_place #bank_central_historic_place
		}
		owner = {
			add_modifier = {
				name = has_central_bank
			}
			set_variable = {
				name = central_bank_location
				value = $CTRL_BANK_SITE$
			}
		}
	}
	$FIN_CENT_SITE$ = {
		create_building = {
			building = $FIN_BLDG_TYPE$
			level    = $FC_SIZE$
			reserves = 1
		}
		add_modifier = {
			name = financial_center_place_spe #special
		}
		add_modifier = {
			name = financial_center_historic_place #bank_central_historic_place
		}
		owner = {
			add_modifier = {
				name = has_financial_center
			}
			set_variable = {
				name = financial_center_location
				value = $FIN_CENT_SITE$
			}
		}
	}
	## doesn't work
	#gdp_view_on_action = yes
	#macro_facilities_on_action = yes
}

## for adding central bank and financial center at game start
initialize_historic_macro_facilities = {
	add_technology_researched = financial_center
	add_technology_researched = central_banking
	add_technology_researched = gold_standard
	add_technology_researched = stock_exchange

	$CTRL_BANK_SITE$ = {
		create_building = {
			building = $BANK_BLDG_TYPE$
			level    = $CB_SIZE$
			reserves = 0
		}
		add_modifier = {
			name = bank_central_place
		}
		add_modifier = {
			name = bank_central_historic_place #bank_central_historic_place
		}
		owner = {
			add_modifier = {
				name = has_central_bank
			}
			set_variable = {
				name = central_bank_location
				value = $CTRL_BANK_SITE$
			}
		}
	}
	$FIN_CENT_SITE$ = {
		create_building = {
			building = $FIN_BLDG_TYPE$
			level    = $FC_SIZE$
			reserves = 1
		}
		add_modifier = {
			name = financial_center_place
		}
		add_modifier = {
			name = financial_center_historic_place #bank_central_historic_place
		}
		owner = {
			add_modifier = {
				name = has_financial_center
			}
			set_variable = {
				name = financial_center_location
				value = $FIN_CENT_SITE$
			}
		}
	}
	## doesn't work
	#gdp_view_on_action = yes
	#macro_facilities_on_action = yes
}

## for adding national stockpile at game start
initialize_historic_stockpile = {
	add_technology_researched = national_stockpile

	$STOCKPILE_SITE$ = {
		create_building = {
			building = building_national_stockpile
			level = 1
		}
		add_modifier = {
			name = national_stockpile_place
		}
		add_modifier = {
			name = national_stockpile_historic_place #bank_central_historic_place
		}
		owner = {
			add_modifier = {
				name = has_national_stockpile
			}
			set_variable = {
				name = stockpile_location
				value = $STOCKPILE_SITE$
			}
		}
	}
}

initialize_new_central_bank = {
	$CTRL_BANK_SITE$ = {
		create_building = {
			building = building_bank
			level    = 5
			reserves = 0
		}
		add_modifier = {
			name = bank_central_place
		}
		owner = {
			add_modifier = {
				name = has_central_bank
			}
			set_variable = {
				name = central_bank_location
				value = $CTRL_BANK_SITE$
			}
		}
	}

	## resize the new bank
	macro_facilities_on_action = yes
}

## TODO
central_bank_sanity_check = {
	## sanity check that the central bank location is within the country;
	## will probably break with TPG and GER
	if = {
		limit = {
			not = { has_technology_researched = central_banking }
			any_scope_state = {
				or = {
					has_building = building_bank
					#has_building = building_bank_usa
				}
			}
		}
		every_scope_state = {
			limit = 
		}
	}

	if = {
		limit = {
			not = {
				exists = var:central_bank_location
				var:central_bank_location.owner = this
			}
		}
		reinitialize_central_bank = yes
	}


}
reinitialize_central_bank = {}

## TODO
reinitialize_financial_center = {}

macro_facilities_cb_pass = {
	central_bank_sanity_check = yes
	
	if = {
		limit = {
			has_technology_researched = central_banking
			var:central_bank_location = {
				has_modifier = bank_central_historic_place
			}
		}
		switch = {
			trigger = var:central_bank_location
			s:STATE_PENNSYLVANIA.region_state:USA = {
				s:STATE_PENNSYLVANIA.region_state:USA = {
					create_building = {
						#building = building_bank_usa
						building = building_bank
						level    = $SIZE$
					}
				}
			}
			fallback = {
				var:central_bank_location = {
					create_building = {
						building = building_bank
						level    = $SIZE$
					}
				}
			}
		}
	}
}

macro_facilities_fc_pass = {
	## sanity check that the financial center location is within the country;
	## will probably break with TPG and GER
	if = {
		limit = {
			has_technology_researched = financial_center
			not = {
				exists = var:financial_center_location
				var:financial_center_location.owner = this
			}
		}
		reinitialize_financial_center = yes
	}

	if = {
		limit = {
			has_technology_researched = financial_center
			var:financial_center_location = {
				has_modifier = financial_center_historic_place
			}
		}

		switch = {
			trigger = var:financial_center_location
		
			#FRA
			s:STATE_ILE_DE_FRANCE.region_state:FRA = {
				s:STATE_ILE_DE_FRANCE.region_state:FRA = {
					create_building = {
						building = building_financial_centre_fra
						level    = $SIZE$
					}
				}
			}

			#GBR
			s:STATE_HOME_COUNTIES.region_state:GBR = {
				s:STATE_HOME_COUNTIES.region_state:GBR = {
					create_building = {
						building = s:STATE_HOME_COUNTIES.region_state:GBR
						level    = $SIZE$
					}
				}
			}

			#USA
			s:STATE_NEW_YORK.region_state:USA = {
				s:STATE_NEW_YORK.region_state:USA = {
					create_building = {
						building = building_financial_centre_usa
						level    = $SIZE$
					}
				}
			}

			#NET
			s:STATE_HOLLAND.region_state:NET = {
				s:STATE_HOLLAND.region_state:NET = {
					create_building = {
						building = building_financial_centre_net
						level    = $SIZE$
					}
				}
			}

			#PRU
			s:STATE_BRANDENBURG.region_state:PRU = {
				s:STATE_BRANDENBURG.region_state:PRU = {
					create_building = {
						building = building_financial_centre_ger
						level    = $SIZE$
					}
				}
			}

			#GER
			s:STATE_BRANDENBURG.region_state:GER = {
				s:STATE_BRANDENBURG.region_state:GER = {
					create_building = {
						building = building_financial_centre_ger
						level    = $SIZE$
					}
				}
			}

			#AUS
			s:STATE_AUSTRIA.region_state:AUS = {
					s:STATE_AUSTRIA.region_state:AUS = {
					create_building = {
						building = building_financial_centre_aus
						level    = $SIZE$
					}
				}
			}

			#ITA
			s:STATE_LOMBARDY.region_state:ITA = {
				s:STATE_LOMBARDY.region_state:ITA = {
					create_building = {
						building = building_financial_centre_ita
						level    = $SIZE$
					}
				}
			}

			#CHI
			s:STATE_SHAOZHOU.region_state:CHI = {
				s:STATE_SHAOZHOU.region_state:CHI = {
					create_building = {
						building = building_financial_centre_chi
						level    = $SIZE$
					}
				}
			}

			#TPG
			s:STATE_SHAOZHOU.region_state:TPG = {
				s:STATE_SHAOZHOU.region_state:TPG = {
					create_building = {
						building = building_financial_centre_chi
						level    = $SIZE$
					}
				}
			}

			#JAP
			s:STATE_KANTO.region_state:JAP = {
				s:STATE_KANTO.region_state:JAP = {
					create_building = {
						building = building_financial_centre_jap
						level    = $SIZE$
					}
				}
			}

			#other
			fallback = {
				var:financial_center_location = {
					create_building = {
						building = building_financial_centre
						level    = $SIZE$
					}
				}
			}
		}
	}

	#finished with fc, continue on to cb
	macro_facilities_cb_pass = {
		SIZE = $SIZE$
	}
}

macro_facilities_size_pass = {
	switch = {
		trigger = var:gdp_view
		1 = {
			macro_facilities_fc_pass = {
				SIZE = 5
			}
		}
		2 = {
			macro_facilities_fc_pass = {
				SIZE = 10
			}
		}
		3 = {
			macro_facilities_fc_pass = {
				SIZE = 15
			}
		}
		4 = {
			macro_facilities_fc_pass = {
				SIZE = 20
			}
		}
		5 = {
			macro_facilities_fc_pass = {
				SIZE = 25
			}
		}
		6 = {
			macro_facilities_fc_pass = {
				SIZE = 30
			}
		}
		7 = {
			macro_facilities_fc_pass = {
				SIZE = 35
			}
		}
		8 = {
			macro_facilities_fc_pass = {
				SIZE = 40
			}
		}
		9 = {
			macro_facilities_fc_pass = {
				SIZE = 45
			}
		}
		10 = {
			macro_facilities_fc_pass = {
				SIZE = 50
			}
		}
		11 = {
			macro_facilities_fc_pass = {
				SIZE = 55
			}
		}
		12 = {
			macro_facilities_fc_pass = {
				SIZE = 60
			}
		}
		13 = {
			macro_facilities_fc_pass = {
				SIZE = 65
			}
		}
		14 = {
			macro_facilities_fc_pass = {
				SIZE = 70
			}
		}
		15 = {
			macro_facilities_fc_pass = {
				SIZE = 75
			}
		}
		16 = {
			macro_facilities_fc_pass = {
				SIZE = 80
			}
		}
		17 = {
			macro_facilities_fc_pass = {
				SIZE = 85
			}
		}
		18 = {
			macro_facilities_fc_pass = {
				SIZE = 90
			}
		}
		19 = {
			macro_facilities_fc_pass = {
				SIZE = 95
			}
		}
		20 = {
			macro_facilities_fc_pass = {
				SIZE = 100
			}
		}
		21 = {
			macro_facilities_fc_pass = {
				SIZE = 105
			}
		}
		22 = {
			macro_facilities_fc_pass = {
				SIZE = 110
			}
		}
		23 = {
			macro_facilities_fc_pass = {
				SIZE = 115
			}
		}
		24 = {
			macro_facilities_fc_pass = {
				SIZE = 120
			}
		}
		25 = {
			macro_facilities_fc_pass = {
				SIZE = 125
			}
		}
		26 = {
			macro_facilities_fc_pass = {
				SIZE = 130
			}
		}
		27 = {
			macro_facilities_fc_pass = {
				SIZE = 135
			}
		}
		28 = {
			macro_facilities_fc_pass = {
				SIZE = 140
			}
		}
		29 = {
			macro_facilities_fc_pass = {
				SIZE = 145
			}
		}
		30 = {
			macro_facilities_fc_pass = {
				SIZE = 150
			}
		}
		31 = {
			macro_facilities_fc_pass = {
				SIZE = 155
			}
		}
		32 = {
			macro_facilities_fc_pass = {
				SIZE = 160
			}
		}
		33 = {
			macro_facilities_fc_pass = {
				SIZE = 165
			}
		}
		34 = {
			macro_facilities_fc_pass = {
				SIZE = 170
			}
		}
		35 = {
			macro_facilities_fc_pass = {
				SIZE = 175
			}
		}
		36 = {
			macro_facilities_fc_pass = {
				SIZE = 180
			}
		}
		37 = {
			macro_facilities_fc_pass = {
				SIZE = 185
			}
		}
		38 = {
			macro_facilities_fc_pass = {
				SIZE = 190
			}
		}
		39 = {
			macro_facilities_fc_pass = {
				SIZE = 195
			}
		}
		40 = {
			macro_facilities_fc_pass = {
				SIZE = 200
			}
		}
		41 = {
			macro_facilities_fc_pass = {
				SIZE = 205
			}
		}
		42 = {
			macro_facilities_fc_pass = {
				SIZE = 210
			}
		}
		43 = {
			macro_facilities_fc_pass = {
				SIZE = 215
			}
		}
		44 = {
			macro_facilities_fc_pass = {
				SIZE = 220
			}
		}
		45 = {
			macro_facilities_fc_pass = {
				SIZE = 225
			}
		}
		46 = {
			macro_facilities_fc_pass = {
				SIZE = 230
			}
		}
		47 = {
			macro_facilities_fc_pass = {
				SIZE = 235
			}
		}
		48 = {
			macro_facilities_fc_pass = {
				SIZE = 240
			}
		}
		49 = {
			macro_facilities_fc_pass = {
				SIZE = 245
			}
		}
		50 = {
			macro_facilities_fc_pass = {
				SIZE = 250
			}
		}
		51 = {
			macro_facilities_fc_pass = {
				SIZE = 255
			}
		}
		52 = {
			macro_facilities_fc_pass = {
				SIZE = 260
			}
		}
		53 = {
			macro_facilities_fc_pass = {
				SIZE = 265
			}
		}
		54 = {
			macro_facilities_fc_pass = {
				SIZE = 270
			}
		}
		55 = {
			macro_facilities_fc_pass = {
				SIZE = 275
			}
		}
		56 = {
			macro_facilities_fc_pass = {
				SIZE = 280
			}
		}
		57 = {
			macro_facilities_fc_pass = {
				SIZE = 285
			}
		}
		58 = {
			macro_facilities_fc_pass = {
				SIZE = 290
			}
		}
		59 = {
			macro_facilities_fc_pass = {
				SIZE = 295
			}
		}
		60 = {
			macro_facilities_fc_pass = {
				SIZE = 300
			}
		}
		61 = {
			macro_facilities_fc_pass = {
				SIZE = 305
			}
		}
		62 = {
			macro_facilities_fc_pass = {
				SIZE = 310
			}
		}
		63 = {
			macro_facilities_fc_pass = {
				SIZE = 315
			}
		}
		64 = {
			macro_facilities_fc_pass = {
				SIZE = 320
			}
		}
		65 = {
			macro_facilities_fc_pass = {
				SIZE = 325
			}
		}
		66 = {
			macro_facilities_fc_pass = {
				SIZE = 330
			}
		}
		67 = {
			macro_facilities_fc_pass = {
				SIZE = 335
			}
		}
		68 = {
			macro_facilities_fc_pass = {
				SIZE = 340
			}
		}
		69 = {
			macro_facilities_fc_pass = {
				SIZE = 345
			}
		}
		70 = {
			macro_facilities_fc_pass = {
				SIZE = 350
			}
		}
		71 = {
			macro_facilities_fc_pass = {
				SIZE = 355
			}
		}
		72 = {
			macro_facilities_fc_pass = {
				SIZE = 360
			}
		}
		73 = {
			macro_facilities_fc_pass = {
				SIZE = 365
			}
		}
		74 = {
			macro_facilities_fc_pass = {
				SIZE = 370
			}
		}
		75 = {
			macro_facilities_fc_pass = {
				SIZE = 375
			}
		}
		76 = {
			macro_facilities_fc_pass = {
				SIZE = 380
			}
		}
		77 = {
			macro_facilities_fc_pass = {
				SIZE = 385
			}
		}
		78 = {
			macro_facilities_fc_pass = {
				SIZE = 390
			}
		}
		79 = {
			macro_facilities_fc_pass = {
				SIZE = 395
			}
		}
		80 = {
			macro_facilities_fc_pass = {
				SIZE = 400
			}
		}
		81 = {
			macro_facilities_fc_pass = {
				SIZE = 405
			}
		}
		82 = {
			macro_facilities_fc_pass = {
				SIZE = 410
			}
		}
		83 = {
			macro_facilities_fc_pass = {
				SIZE = 415
			}
		}
		84 = {
			macro_facilities_fc_pass = {
				SIZE = 420
			}
		}
		85 = {
			macro_facilities_fc_pass = {
				SIZE = 425
			}
		}
		86 = {
			macro_facilities_fc_pass = {
				SIZE = 430
			}
		}
		87 = {
			macro_facilities_fc_pass = {
				SIZE = 435
			}
		}
		88 = {
			macro_facilities_fc_pass = {
				SIZE = 440
			}
		}
		89 = {
			macro_facilities_fc_pass = {
				SIZE = 445
			}
		}
		90 = {
			macro_facilities_fc_pass = {
				SIZE = 450
			}
		}
		91 = {
			macro_facilities_fc_pass = {
				SIZE = 455
			}
		}
		92 = {
			macro_facilities_fc_pass = {
				SIZE = 460
			}
		}
		93 = {
			macro_facilities_fc_pass = {
				SIZE = 465
			}
		}
		94 = {
			macro_facilities_fc_pass = {
				SIZE = 470
			}
		}
		95 = {
			macro_facilities_fc_pass = {
				SIZE = 475
			}
		}
		96 = {
			macro_facilities_fc_pass = {
				SIZE = 480
			}
		}
		97 = {
			macro_facilities_fc_pass = {
				SIZE = 485
			}
		}
		98 = {
			macro_facilities_fc_pass = {
				SIZE = 490
			}
		}
		99 = {
			macro_facilities_fc_pass = {
				SIZE = 495
			}
		}
		100 = {
			macro_facilities_fc_pass = {
				SIZE = 500
			}
		}
	}
}

macro_facilities_on_action = {
	if = {
		limit = { ### check to make sure we're ready and stable enough
			var:gdp_view     >= 1
			country_rank     >= rank_value:unrecognized_regional_power
			is_revolutionary =  no
		}
		macro_facilities_size_pass = yes
	}
}

has_tech_central_bank_but_no_building_central_bank = {
	### redundancy: treated in event original_currency_event.1
	if = {
		limit = {
			has_variable = central_bank_location
			not = { exists = var:central_bank_location }
		}
		remove_variable = central_bank_location
	}

	if = {
		limit = { ### check to make sure we're ready and stable enough
			or = {
				#var:gdp_view = 1
				country_rank >= rank_value:unrecognized_regional_power
				is_player = yes
			}
			has_technology_researched = central_banking
			is_revolutionary = no
			not  = {
				#has_modifier = has_central_bank #for the future replace all occurrences to the building for occurrences to the country modifier
				any_scope_state = {
					has_building = building_bank
				}
			}
		}
		### redundancy: treated in event original_currency_event.1
		scope:central_bank_site = {
			create_building = {
			   building = building_bank
			   level = 5
			   #reserves=1
			}
		}
        add_modifier = {
            name = has_central_bank
        }
		if = {
			limit = {
				has_law = law_type:law_no_market_liquidity
			}
			trigger_event = {
				id = original_currency_event.1
			}
		}
	}
}
has_tech_financial_center_but_no_building_financial_center = {
	### redundancy: treated in event original_currency_event.1
	capital = {
		save_scope_as = financial_center_site
	}
	if = {
		limit = { ### check to make sure we're ready and stable enough
			or = {
				var:gdp_view = 1
				country_rank >= rank_value:unrecognized_regional_power
				is_player = yes
			}
			has_technology_researched = financial_center
			is_revolutionary = no
			not = {
				has_modifier = has_financial_center 
			}
		}
		scope:financial_center_site = {
			create_building = {
			   building = building_financial_centre
			   level = 5
			   #reserves=1
			}
		}
        add_modifier = {
            name = has_financial_center
        }
	}
}

#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################

# ███╗   ██╗ █████╗ ████████╗██╗ ██████╗ ███╗   ██╗ █████╗ ██╗             ███████╗████████╗ ██████╗  ██████╗██╗  ██╗██████╗ ██╗██╗     ███████╗
# ████╗  ██║██╔══██╗╚══██╔══╝██║██╔═══██╗████╗  ██║██╔══██╗██║             ██╔════╝╚══██╔══╝██╔═══██╗██╔════╝██║ ██╔╝██╔══██╗██║██║     ██╔════╝
# ██╔██╗ ██║███████║   ██║   ██║██║   ██║██╔██╗ ██║███████║██║             ███████╗   ██║   ██║   ██║██║     █████╔╝ ██████╔╝██║██║     █████╗
# ██║╚██╗██║██╔══██║   ██║   ██║██║   ██║██║╚██╗██║██╔══██║██║             ╚════██║   ██║   ██║   ██║██║     ██╔═██╗ ██╔═══╝ ██║██║     ██╔══╝
# ██║ ╚████║██║  ██║   ██║   ██║╚██████╔╝██║ ╚████║██║  ██║███████╗███████╗███████║   ██║   ╚██████╔╝╚██████╗██║  ██╗██║     ██║███████╗███████╗
# ╚═╝  ╚═══╝╚═╝  ╚═╝   ╚═╝   ╚═╝ ╚═════╝ ╚═╝  ╚═══╝╚═╝  ╚═╝╚══════╝╚══════╝╚══════╝   ╚═╝    ╚═════╝  ╚═════╝╚═╝  ╚═╝╚═╝     ╚═╝╚══════╝╚══════╝
#
#  ██████╗██████╗ ███████╗ █████╗ ████████╗██╗ ██████╗ ███╗   ██╗
# ██╔════╝██╔══██╗██╔════╝██╔══██╗╚══██╔══╝██║██╔═══██╗████╗  ██║
# ██║     ██████╔╝█████╗  ███████║   ██║   ██║██║   ██║██╔██╗ ██║
# ██║     ██╔══██╗██╔══╝  ██╔══██║   ██║   ██║██║   ██║██║╚██╗██║
# ╚██████╗██║  ██║███████╗██║  ██║   ██║   ██║╚██████╔╝██║ ╚████║
#  ╚═════╝╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝   ╚═╝   ╚═╝ ╚═════╝ ╚═╝  ╚═══╝

#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################
#####################################################################################################################################################

national_stockpile_1 = {
    capital = {
        save_scope_as = national_stockpile_site
    }
	if = {
		limit = {
            is_revolutionary = no
            or = {
                has_technology_researched = national_stockpile
                country_rank >= rank_value:great_power
            }
            not  = {
                or = {
                    is_subject = yes
                    is_subject_type = subject_type_customs_union
                    is_subject_type = subject_type_protectorate
                }
            }
		}
        scope:national_stockpile_site = {
            create_building = {
               building = building_national_stockpile
               level = 1
               #reserves=1
            }
        }
    }
}
