##########################################################################################################################
##########################################################################################################################
##########################################################################################################################
#############################################OPEN GENERAL TEST############################################################

Open_Test_Decision = {
	is_shown = {
		NOT = { has_variable = openTestDecision_variable }
	}
	possible = {
	}

	ai_chance = {
		base = 0
    }
	when_taken = {
		set_variable = openTestDecision_variable
	}
}
Close_Test_Decison = {
	is_shown = {
		has_variable = openTestDecision_variable
	}

	possible = {

	}

	ai_chance = {
		base = 0
    }
	when_taken = {
		remove_variable = openTestDecision_variable
	}
}

##########################################################################################################################
##########################################################################################################################
##########################################################################################################################
#############################################TEST CHOISE#################################################################

Test_event_1 = {
	is_shown = {
		has_variable = openTestDecision_variable
		
	}

	possible = {
	}

	ai_chance = {
		base = 0
    }

	when_taken = {	  
		#arbitrage du bimétallisme
		#gold_drain
		if = { 
			# gold_to_silver_rate {or international à 15}
			# bimetallic_rate_gold_to_silver {or local fixé à 13}
			# -> or local moins chère qu el'or intranational  
			# -> vente d'argent contre de l'or et revent de cette or à l'étranger 

			limit = {
				gold_to_silver_rate > bimetallic_rate_gold_to_silver
				misalignment_rate_gold_drain >= 0.05
			} 
			every_scope_state = {
				if = {
					limit = {
						has_modifier = central_bank_historic_place
						is_capital = yes
					}
					save_scope_as = central_bank_site_seller
				}
			}
			#arbitrage 
			scope:central_bank_site_seller = { 
				change_variable = {
					name = gold_state_1
					subtract = owner.gold_lost

				}
				change_variable = {
					name = silver_state_1
					add = owner.silver_gained
				}
			}   

			capital= {
				save_scope_as = capital_state
			}
			save_scope_as = target_country

			random_in_list = {
				variable = privat_bank_variable_list_ordered
				save_scope_as = arbitrage_privat_bank_1
			} 
			random_in_list = {
				variable = privat_bank_variable_list_ordered
				save_scope_as = arbitrage_privat_bank_2
			} 
			random_in_list = {
				variable = privat_bank_variable_list_ordered
				save_scope_as = arbitrage_privat_bank_3
			} 
			random_in_list = {
				variable = privat_bank_variable_list_ordered
				save_scope_as = arbitrage_privat_bank_4
			} 
			random_in_list = {
				variable = privat_bank_variable_list_ordered
				save_scope_as = arbitrage_privat_bank_5
			} 

			#Test AI
			trigger_event = 00_ef_economic_event.95

			if = {
				limit = {
					is_player = yes  
				}   
				trigger_event = 00_ef_economic_event.95
			}   
		} 
		#silver_drain
		if = { 
			# gold_to_silver_rate {or international à 13}
			# bimetallic_rate_gold_to_silver {or local fixé à 15}
			# -> or local plus chère qu el'or intranational  
			# -> vente d'or contre de l'argent et revent de cette argent à l'étranger

			limit = {
				gold_to_silver_rate < bimetallic_rate_gold_to_silver
				misalignment_rate_silver_drain >= 0.05
			}  
			every_scope_state = {
				if = {
					limit = {
						has_modifier = central_bank_historic_place
						is_capital = yes
					}
					save_scope_as = central_bank_site_seller
				}
			}
			#arbitrage  
			scope:central_bank_site_seller = { 
				change_variable = {
					name = gold_state_1
					add = owner.gold_gained

				}
				change_variable = {
					name = silver_state_1
					subtract = owner.silver_lost
				}
			} 
 
			capital= {
				save_scope_as = capital_state
			}
			save_scope_as = target_country

			random_in_list = {
				variable = privat_bank_variable_list_ordered
				save_scope_as = arbitrage_privat_bank_1
			} 
			random_in_list = {
				variable = privat_bank_variable_list_ordered
				save_scope_as = arbitrage_privat_bank_2
			} 
			random_in_list = {
				variable = privat_bank_variable_list_ordered
				save_scope_as = arbitrage_privat_bank_3
			} 
			random_in_list = {
				variable = privat_bank_variable_list_ordered
				save_scope_as = arbitrage_privat_bank_4
			} 
			random_in_list = {
				variable = privat_bank_variable_list_ordered
				save_scope_as = arbitrage_privat_bank_5
			} 
 
			#Test AI
			trigger_event = 00_ef_economic_event.96

			if = {
				limit = {
					is_player = yes  
				}   
				trigger_event = 00_ef_economic_event.96
			}   
		}    
	}
}

Test_event_2 = {
	is_shown = {
		has_variable = openTestDecision_variable
		
	}

	possible = {
	}

	ai_chance = {
		base = 0
    }

	when_taken = {    
		every_country = { 
			if = {
				limit = {
					c:FRA ?= this
				}
				add_company = company_type:company_BanqueDeFrance
				add_company = company_type:company_Rothschild_Bank_fra
				add_company = company_type:company_basic_gold_and_silver_mining_2
				company:company_BanqueDeFrance = {
					set_company_establishment_date = 1830.1.1
					set_company_state_region = s:STATE_ILE_DE_FRANCE
				}
				company:company_Rothschild_Bank_fra = {
					set_company_establishment_date = 1830.1.1
					set_company_state_region = s:STATE_ILE_DE_FRANCE
				}
				company:company_basic_gold_and_silver_mining_2 = {
					set_company_establishment_date = 1830.1.1
					set_company_state_region = s:STATE_ILE_DE_FRANCE
				}
			}
		} 
	}
}

Test_event_3 = {
	is_shown = {
		has_variable = openTestDecision_variable
		
	}

	possible = {
	}

	ai_chance = {
		base = 0
    }

	when_taken = {
		
		set_variable = {
			name = central_bank_bankruptcy
			value = 0
		}
	}
}

Test_event_4 = {
	is_shown = {
		has_variable = openTestDecision_variable
		
	}

	possible = {
	}

	ai_chance = {
		base = 0
    }

	when_taken = {
		trigger_event = {
			id = test_2.4
			days = 0
			popup = no
		}
	}
}

Test_event_5 = {
	is_shown = {
		has_variable = openTestDecision_variable
		
	}

	possible = {
	}

	ai_chance = {
		base = 0
    }

	when_taken = {
		every_country = { 
			 		 
		}
 
		set_global_variable = {
			name = silver_to_gold_rate_fixe_var_1_1Y
			value = 0
		} 
		set_global_variable = {
			name = silver_to_gold_rate_var_half_1_year
			value = 0
		}
		set_global_variable = {
			name = silver_to_gold_rate_var_1_year
			value = 0
		}
		set_global_variable = {
			name = silver_to_gold_rate_dif_1
			value = 0
		} 
		set_global_variable = {
			name = global_silver_production_cumulative_production
			value = 0
		} 
	}
}